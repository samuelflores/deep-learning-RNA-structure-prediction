firstStage 7 
lastStage 7

readAtStage 2
reportingInterval .1
readBlockEnd

readAtStage 2
# chain R is the RNA
loadSequencesFromPdb 1sj3.short.renum.pdb
#        UGGCCGGCAUGGUCCCAGCCUCCUCGCUGGCGCCGGCUGGGCAACACCAUUGCACUCCGGUGGUGAAUGGGAC
# P1: according to Ke and Doudna, and in agreement with 1sj3-renumbered:
#         GGCCGGC (1-7)                 GCCGGCU (31-37)
# P4:                                               ACACC (43-47)  GGUGG (58-62)  
# renumbering should hopefully now match HPV ribozyme numbering in Ke&Doudna 2004 https://www.nature.com/articles/nature02522.pdf
# template chain should be rigid, and may as well fix to ground:

# chain 1 is CBEP3, see Benedixsen et al 2021, for numbering and secondary structure, https://academic.oup.com/mbe/article/38/7/2843/6171150?login=true
RNA 1 1   GGGGGCCACAGCAGAAGCGUUCACGUCGCGGCCCCUGUCAGCCAUUGCACUCCGGCUGCGAAUUCUGCU
#    P1   GGGGGCC                      GGCCCCU                                 
#    P1.1                      CA (22-23)     GU (37-38)                         
#         P2       AGCAGAA                                            AAUUCUGCU
#         P3              GCG       CGC
#                                          J4/5                     CGAA
#                                          CCUGUCAGCCAUUGCACUCCGGCUGCGA
#                                          L4        AUUGCACUCC
#                                          P4   CAGCC          GGCUG   
#                                               CAGCCAU       CGGCUGCG          
#                                               CAGAUUC(39 GAAUCUG
#                      For pairing with HPV:    CAGAU        AUCUG
readBlockEnd

readFromStage 3
loadSequencesFromPdb
readBlockEnd

mobilizer Rigid R
rootMobilizer R Weld

alignmentForces noGap
alignmentForces forceConstant 300
#P1:
alignmentForces R 1 7 1 1 7
alignmentForces R 31 37 1  30 36
# P1.1:
# note 38-36 alignment is redundant with P1..
alignmentForces R 38 38 1 37 37
alignmentForces R 39 39 1 38 38
alignmentForces R 21 22 1 22 23
#P2: # chain R residue 73 is not resolved.
alignmentForces R 10 16 1  10 16
alignmentForces R 67 72 1  61 67
#J4/2:
#just to pull this loop a bit more to where it should go:
alignmentForces R 63 66 1  57 60
#P3:
alignmentForces R 17 19 1 17 19 
alignmentForces R 28 30 1 27 29
# just to pull loop L3 out of the way. but don't involve chain 1 res 23, it is busy with P1.1.
alignmentForces R 25 27 1 24 26
#P4:
alignmentForces R 43 47 1 39 43
alignmentForces R 58 62 1 52 56


# Ignore P1.1, present in HPV, and possibly also in the pre-cleaved CBEP3, but here we have the cleaved.

readAtStage 1000
setDefaultMDParameters
globalCoulombScaleFactor .1

# limit the force field to chain 1:
includeResidues 1 FirstResidue 36 
includeResidues 1 39 LastResidue
#these residues should be excluded from the force field, to allow them to get where they are going:
#1 37 38
readBlockEnd

